# nightmare-sign


ä»€ä¹ˆå€¼å¾—ä¹°è‡ªåŠ¨ç­¾åˆ° ï¼š 
> 2020å¹´09æœˆ09æ—¥
>
> æ–°å¢ä¸€ä¸ªåŸºäºè°·æ­Œæ— å¤´æµè§ˆå™¨å®ç°çš„ç­¾åˆ°å·¥ç¨‹ï¼Œæ”¯æŒsmzdmç­¾åˆ°ã€‚å®Œå…¨æ¨¡æ‹Ÿäººå·¥ç‚¹å‡»ã€‚æ¬¢è¿å°è¯•ã€‚
>
> åœ°å€ï¼š[https://github.com/xuess/puppeteer-sign](https://github.com/xuess/puppeteer-sign)


##ã€€2018-8-30 æ›´æ–°

> äº¬ä¸œç™»é™†åˆ é™¤ç™»é™†éªŒè¯ç ï¼Œæ›´æ–°ä»£ç ï¼Œæ”¾å¼€äº¬ä¸œç­¾åˆ°åŠŸèƒ½ã€‚

##ã€€2018-8-12 æ›´æ–°

> äº¬ä¸œç™»é™†æ·»åŠ éªŒè¯ç ï¼Œç›®å‰æ²¡åŠæ³•æ”»å…‹è‡ªåŠ¨è¯†åˆ«è¾“å…¥éªŒè¯ç ï¼Œæ¯æ¬¡éƒ½æŠ¥é”™å‘é‚®ä»¶ï¼Œæ‰€ä»¥æŠŠäº¬ä¸œç­¾åˆ°æš‚æ—¶å»æ‰ã€‚


åŸºäºnodejsã€nightmareï¼Œäº¬ä¸œã€è‹å®è‡ªåŠ¨ç­¾åˆ°ï¼Œè‡ªåŠ¨å‘é‚®ä»¶ï¼Œé€šçŸ¥æ—¥å¿—ä¸æŠ¥é”™ä¿¡æ¯

äº¬ä¸œç­¾åˆ°ï¼ŒåŒ…æ‹¬å°é‡‘åº“ã€äº¬ä¸œä¼šå‘˜ã€äº¬ä¸œé‡‘èç­¾åˆ°ï¼Œè‹å®å°±æ˜¯ç­¾åˆ°é¢†äº‘é’»ã€‚

å®ç°èƒŒæ™¯ï¼šç­¾åˆ°åŠ³ç¥ï¼Œè€½è¯¯å¤§é‡æ—¶é—´ï¼Œå›æŠ¥å´å¾ˆå°‘ï¼Œæ­£å¦‚`ä¸€é¡¿æ“ä½œçŒ›å¦‚è™ï¼Œä¸€çœ‹æ”¶ç›Šä¸€æ¯›äº”`ï¼Œç”¨è„šæœ¬å®ç°ä½ ç­¾åˆ°é¢†è±†ï¼Œè§£æ”¾åŒæ‰‹ã€‚

å®ç°åŸç†ï¼šåŸºäº`nightmare`æµ‹è¯•æ¡†æ¶ï¼Œç¼–å†™å¯¹åº”è„šæœ¬ï¼Œå®ç°è‡ªåŠ¨ç­¾åˆ°ã€‚

é¡¹ç›®è¯´æ˜ï¼šå¦‚æœä¸€ç›´è¿è¡Œï¼Œæœ¬é¡¹ç›®æ¯å¤©6ç‚¹30åˆ†è‡ªåŠ¨æ‰§è¡Œç­¾åˆ°è„šæœ¬ï¼Œ17ç‚¹40åˆ†ï¼Œå‘é€ç­¾åˆ°æ—¥å¿—ï¼Œä¼šæŠŠå½“å¤©ç­¾åˆ°çš„æˆªå›¾å‘é€åˆ°æŒ‡å®šé‚®ç®±é‡Œã€‚

å–œæ¬¢è¯·`star`ï¼Œä¸æ‡‚çš„å¯ä»¥æé—®ã€‚æ‡‚çš„æœ‹å‹ï¼Œå¯ä»¥æŒ‰ç…§è¿™ä¸ªæ€è·¯å¼€å‘æ›´å¤š`è‡ªåŠ¨ç­¾åˆ°`ã€‚

> äº¬ä¸œã€è‹å®è‡ªåŠ¨ç­¾åˆ°é¡¹ç›®ï¼š[https://github.com/xuess/nightmare-sign](https://github.com/xuess/nightmare-sign)
>
> ä»€ä¹ˆå€¼å¾—ä¹°è‡ªåŠ¨ç­¾åˆ°é¡¹ç›®: [https://github.com/xuess/smzdm-sign](https://github.com/xuess/smzdm-sign)


# ä½¿ç”¨æ­¥éª¤

### 0.å‡†å¤‡ç¯å¢ƒ

nodejs è¿è¡Œç¯å¢ƒï¼Œæ³¨æ„ï¼Œéœ€è¦å›¾å½¢ç•Œé¢ä¸‹è¿è¡Œ
å¯ä»¥ç­¾åˆ°çš„äº¬ä¸œå’Œè‹å®è´¦å·

### 1.å¡«å†™è´¦å·ä»¥åŠé…ç½®ä¿¡æ¯

æ‰“å¼€ å·¥ç¨‹æ–‡ä»¶ï¼š`./config.js`

ä¿®æ”¹å¦‚ä¸‹å¯¹åº”ä»£ç 

```javascript
	// email ç™»é™†è´¦å· å¦‚ï¼šxxxx@qq.com
	const emailName = 'wwww@126.com';
	// email ç™»é™†å¯†ç  æ ¹æ®é‚®ç®±ä¸åŒï¼Œå¯†ç å¯èƒ½æ˜¯æˆæƒç éœ€è¦æ³¨æ„
	const emailPassword = 'password';
	// æ¥æ”¶è€… é‚®ç®±
	const toEmail = '10000@qq.com';
	// è´¦å·ä¿¡æ¯
	const userData = [
		{
			type:'jd',
			username: 'è´¦å·',
			password: 'å¯†ç '
		},
		{
			type:'jd',
			username: 'è´¦å·',
			password: 'å¯†ç '
		},
		{
			type:'suning',
			username: 'è´¦å·',
			password: 'å¯†ç '
		},
	];
```


> å¤šè´¦å·æ·»åŠ å¤šä¸ªå˜é‡ï¼Œæ³¨æ„ `type`å€¼ç±»å‹ï¼Œç›®å‰åªæœ‰ä¸¤ç§ `jd`å’Œ `suning`


### 2.å®‰è£…é¡¹ç›®ä¾èµ–ä»¥åŠæ‰§è¡Œè„šæœ¬

```bash
#å®‰è£…ä¾èµ–
npm i  æˆ– cnpm i

#æ‰§è¡Œ è„šæœ¬
node main 

#åå°è¿è¡Œæ‰§è¡Œè„šæœ¬
nohup node main.js &

```

### 3.å…³äºé…ç½®é‚®ç®±

é…ç½®ç›¸å…³ä»£ç ä½ç½®ï¼š`lib/mail.js` line 11

æœ¬é¡¹ç›®ä½¿ç”¨çš„æ˜¯  `nodemailer` å‘é€é‚®ä»¶ï¼Œå¦‚é‡é—®é¢˜ï¼Œå¯ä»¥æœç´¢æ­¤å…³é”®å­—ã€‚

æœ¬é¡¹ç›®ä¸­ç»™çš„æ˜¯`qqé‚®ç®±`ï¼Œå…¶ä»–é‚®ç®±ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚

ğŸ‘‡ç»™å‡ºå…¶ä»–é‚®ä»¶é…ç½®ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ã€‚

```
// é‚®ç®±æ”¯æŒåˆ—è¡¨
https://nodemailer.com/smtp/well-known/ 
// é‚®ç®±é…ç½®ä¿¡æ¯ åˆ—è¡¨
https://github.com/nodemailer/nodemailer-wellknown/blob/master/services.json
```

> æ³¨æ„é‚®ç®±è¦å¼€å¯ POP3/SMTP/IMAPæœåŠ¡ï¼Œç”±äºç¬¬ä¸‰æ–¹ç™»é™†ï¼Œæœ‰äº›éœ€è¦é…ç½®ç­¾åæˆ–æˆæƒç ï¼Œç™»é™†å¯†ç ä¸ºè®¾ç½®çš„ç­¾åæˆ–æˆæƒç ã€‚


### 4.å¦‚æœéœ€è¦é•¿æ—¶é—´è¿è¡Œ è¯·ç”¨`pm2è¿›ç¨‹ç®¡ç†å·¥å…·`

```bash
#å…¨å±€å®‰è£…pm2
npm i pm2 -g 

#å¯åŠ¨ç­¾åˆ°è¿›ç¨‹
pm2 start main.js

#æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹çŠ¶æ€
pm2 list 

#ç›‘è§†æ‰€æœ‰è¿›ç¨‹
pm2 monit              

#æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹æ—¥å¿—
pm2 logs

```

> å…³äº`pm2`çš„è¯¦ç»†ä½¿ç”¨ä»‹ç»è¯·çœ‹  --> [https://www.xueshanshan.com/post/node-npm-pm2.html](https://www.xueshanshan.com/post/node-npm-pm2.html)




**å®šæ—¶é‚®ä»¶ å‘é€æ•ˆæœ**

![](img/email.jpg) 

**æ‰§è¡Œè¿‡ç¨‹æˆªå›¾**

![](img/sign.jpg)
